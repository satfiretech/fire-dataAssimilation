
clear all
clc

close all
%clc

x = 0.001:0.001:0.999; 
T = log(-log(x)); 
plot(x(T>=0),T(T>=0))



x = 0.00001:0.0001:0.8647-0.0001; %x used in fitting (FA probability)
%x = 0.000001:0.000001:0.1;
y = 1 - log(-log(1 - x)); %y used in fitting     (Threshold coefficient)
%z = 1.8333 - 3*log(1-x) + 1.5*log(1-x).^2 + 1/3* log(1-x).^3; 





w = 1 + ((1 + log(1 - x)) + (1 + log(1 - x)).^2/2 + (1 + log(1 - x)).^3/3 + (1 + log(1 - x)).^4/4 + (1 + log(1 - x)).^5/5 + (1 + log(1 - x)).^6/6 + (1 + log(1 - x)).^7/7 + (1 + log(1 - x)).^8/8 + (1 + log(1 - x)).^9/9 + (1 + log(1 - x)).^10/10 + (1 + log(1 - x)).^11/11 + ...
    (1 + log(1 - x)).^12/12 + (1 + log(1 - x)).^13/13 + (1 + log(1 - x)).^14/14 + (1 + log(1 - x)).^15/15 + (1 + log(1 - x)).^16/16 + (1 + log(1 - x)).^17/17 + (1 + log(1 - x)).^18/18 + (1 + log(1 - x)).^19/19 + (1 + log(1 - x)).^20/20 + (1 + log(1 - x)).^21/21 + ... 
    (1 + log(1 - x)).^22/22 + (1 + log(1 - x)).^23/23 + (1 + log(1 - x)).^24/24 + (1 + log(1 - x)).^25/25 + (1 + log(1 - x)).^26/26 + (1 + log(1 - x)).^27/27 + (1 + log(1 - x)).^28/28 + (1 + log(1 - x)).^29/29 + (1 + log(1 - x)).^30/30 + (1 + log(1 - x)).^31/31 + ...
    (1 + log(1 - x)).^32/32 + (1 + log(1 - x)).^33/33 + (1 + log(1 - x)).^34/34 + (1 + log(1 - x)).^35/35 + (1 + log(1 - x)).^36/36 + (1 + log(1 - x)).^37/37 + (1 + log(1 - x)).^38/38 + (1 + log(1 - x)).^39/39 + (1 + log(1 - x)).^40/40 + (1 + log(1 - x)).^41/41 + ...
    (1 + log(1 - x)).^42/42 + (1 + log(1 - x)).^43/43 + (1 + log(1 - x)).^44/44 + (1 + log(1 - x)).^45/45 + (1 + log(1 - x)).^46/46 + (1 + log(1 - x)).^47/47 + (1 + log(1 - x)).^48/48 + (1 + log(1 - x)).^49/49 + (1 + log(1 - x)).^50/50 + (1 + log(1 - x)).^51/51 + ...
    (1 + log(1 - x)).^52/52 + (1 + log(1 - x)).^53/53 + (1 + log(1 - x)).^54/54 + (1 + log(1 - x)).^55/55 + (1 + log(1 - x)).^56/56 + (1 + log(1 - x)).^57/57 + (1 + log(1 - x)).^58/58 + (1 + log(1 - x)).^59/59 + (1 + log(1 - x)).^60/60 + (1 + log(1 - x)).^61/61);

mean((w - y).^2)

figure
plot(x,y,'b')
hold on
%plot(x,z,'r')
%plot(x,w,'g')

r = -0.9469*log(x)  - 1.072*x + 1.212;  %VALID FOR 0<X<1-EXP(-2)
plot(x,r,'r')

mean((r - y).^2)

hold off



% v1 = (1 + log(1-x));% + (1 + log(1-x)).^2/2;
% v2 = -log(x);
% figure
% plot(x,v1)
% hold on
% plot(x,v2,'r')
% hold off