%This file is used to model the (1-Pfa)-quantile standard logistic (or
%threshold coefficient) for the standard Logistic by ignoring the dependency on
%number of samples used in modelling.

clear all
clc

close all
%clc

x = 0.001:0.001:0.999; %Probability(detection)
T = log(x./(1-x)); 
%plot(x,T)
plot(x(T>=0),T(T>=0))



x = 0.000000001:0.000001:0.5; %1/3:0.0001:1; %0.00001:0.0001:0.6667; %False alarm probability
%x = 0.000001:0.000001:0.1;
y = log((1-x)./x); 
% x(y<0) = [];
% y(y<0) = [];
%z = 1.8333 - 3*log(1-x) + 1.5*log(1-x).^2 + 1/3* log(1-x).^3; 





w = -((1 - (1-x)./x) + (1 - (1-x)./x).^2/2 + (1 - (1-x)./x).^3/3 + (1 - (1-x)./x).^4/4 + (1 - (1-x)./x).^5/5 + (1 - (1-x)./x).^6/6 + (1 - (1-x)./x).^7/7 + (1 - (1-x)./x).^8/8 + (1 - (1-x)./x).^9/9 + (1 - (1-x)./x).^10/10 + (1 - (1-x)./x).^11/11 + ...
    (1 - (1-x)./x).^12/12 + (1 - (1-x)./x).^13/13 + (1 - (1-x)./x).^14/14 + (1 - (1-x)./x).^15/15 + (1 - (1-x)./x).^16/16 + (1 - (1-x)./x).^17/17 + (1 - (1-x)./x).^18/18 + (1 - (1-x)./x).^19/19 + (1 - (1-x)./x).^20/20 + (1 - (1-x)./x).^21/21 + ... 
    (1 - (1-x)./x).^22/22 + (1 - (1-x)./x).^23/23 + (1 - (1-x)./x).^24/24 + (1 - (1-x)./x).^25/25 + (1 - (1-x)./x).^26/26 + (1 - (1-x)./x).^27/27 + (1 - (1-x)./x).^28/28 + (1 - (1-x)./x).^29/29 + (1 - (1-x)./x).^30/30 + (1 - (1-x)./x).^31/31 + ...
    (1 - (1-x)./x).^32/32 + (1 - (1-x)./x).^33/33 + (1 - (1-x)./x).^34/34 + (1 - (1-x)./x).^35/35 + (1 - (1-x)./x).^36/36 + (1 - (1-x)./x).^37/37 + (1 - (1-x)./x).^38/38 + (1 - (1-x)./x).^39/39 + (1 - (1-x)./x).^40/40 + (1 - (1-x)./x).^41/41 + ...
    (1 - (1-x)./x).^42/42 + (1 - (1-x)./x).^43/43 + (1 - (1-x)./x).^44/44 + (1 - (1-x)./x).^45/45 + (1 - (1-x)./x).^46/46 + (1 - (1-x)./x).^47/47 + (1 - (1-x)./x).^48/48 + (1 - (1-x)./x).^49/49 + (1 - (1-x)./x).^50/50 + (1 - (1-x)./x).^51/51 + ...
    (1 - (1-x)./x).^52/52 + (1 - (1-x)./x).^53/53 + (1 - (1-x)./x).^54/54 + (1 - (1-x)./x).^55/55 + (1 - (1-x)./x).^56/56 + (1 - (1-x)./x).^57/57 + (1 - (1-x)./x).^58/58 + (1 - (1-x)./x).^59/59 + (1 - (1-x)./x).^60/60 + (1 - (1-x)./x).^61/61);
%1/3<X<1
mean((w - y).^2)

figure
plot(x,y,'b')
hold on
%plot(x,z,'r')
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % plot(x,w,'g')

%r = -0.977*log(x)  - 1.503*x + 0.1078;  %VALID FOR 0<X<1/2 for T>=0: step e-4
%r = -0.9758*log(x)  - 1.51*x + 0.1116;  %VALID FOR 0<X<1/2 for T>=0: step e-5
r = -0.9757*log(x)  - 1.51*x + 0.1119;  %VALID FOR 0<X<1/2 for T>=0: step e-6

plot(x,r,'r')
% 
mean((r - y).^2)

hold off


% v1 = (1 + log(1-x));% + (1 + log(1-x)).^2/2;
% v2 = -log(x);
% figure
% plot(x,v1)
% hold on
% plot(x,v2,'r')
% hold off